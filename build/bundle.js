

let baseUrl="http://localhost:5250/",tenantToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImUzNjMyMTc3LWM0NjktNGQ3MC1hNGRhLTU1ZDQwNWZjNTY0NCIsIm5iZiI6MTc0MjQ4OTE3OSwiZXhwIjoyNTM0MDIzMDA4MDAsImlhdCI6MTc0MjQ4OTE3OX0.qJeUajx0vOsomM2z0KwduWgEzbWf4hmy1m9mbqmcfkY";function main(){document.addEventListener("DOMContentLoaded",()=>{sendInteractionsToOrderVtex();let t=0,n=setInterval(async()=>{console.log(t);var e=document.getElementById("corel_container");5<++t?clearInterval(n):e&&(fetchProducts().then(e=>{"fulfilled"===e[0].status&&renderShelf(e[0]?.value)}).then(()=>{initializeSlider()}),clearInterval(n))},500)})}main();
let getDataSetFromElement=e=>{var t=document.getElementById(e);return t?t.dataset:(console.error(`Element with id ${e} not found`),null)},fetchProducts=async()=>{var{skuid:e,itemsfetched:t}=getDataSetFromElement("corel_container"),n=(console.log(e,t),{method:"GET",headers:{Authorization:"Bearer "+tenantToken,"Content-Type":"application/json; charset=utf-8"}});try{var a,r=await fetch(baseUrl+`v1/skus/${e}?batchSize=`+t,n);if(r.ok)return a=await r.json(),console.log(a),await Promise.allSettled([a]);throw new Error("Network response was not ok")}catch(e){console.error("Fetch error:",e)}},productClickHandler=(e,t,n)=>{saveClick(t,n)},saveClick=(e,t)=>{e={originUrl:window?.location?.pathname,targetUrl:e,origin:t,readCount:0};let n;var t=localStorage.getItem("currentShelfInteractions");n=t?((t=JSON.parse(t)).push(e),t):[e],localStorage.setItem("currentShelfInteractions",JSON.stringify(n))},renderShelf=e=>{let o=getDataSetFromElement("corel_container").imgsize;var t=document.getElementById("corel_container"),n=document.createElement("div"),a=(n.className="shelfWrapper",document.createElement("h4"));a.className="shelfTitle",a.textContent="Recomendados para vocÃª";let c=document.createElement("div");c.className="sliderContainer";var r=document.createElement("button"),l=(r.className="prevButton",r.innerHTML="&#10094;",document.createElement("button"));l.className="nextButton",l.innerHTML="&#10095;",n.appendChild(r),n.appendChild(l),e.forEach((t,e)=>{var n=document.createElement("div"),a=(n.className="shelfItem",n.setAttribute("sku_id",t?.externalId),n.setAttribute("product_id",t?.externalProductId),n.addEventListener("click",()=>{productClickHandler(t?.externalId,t?.uri,"upsell")}),n.addEventListener("auxclick",e=>{(1===e.button||0===e.button&&(e.ctrlKey||e.metaKey))&&productClickHandler(t?.externalId,t?.uri,"upsell")}),n.addEventListener("contextmenu",e=>{productClickHandler(t?.externalId,t?.uri,"upsell")}),document.createElement("a")),r=(a.className="shelfItemLink",a.href=t?.uri,document.createElement("img")),l=(r.className="shelfItemImage",r.src=t?.imageUrl?.replace(/\/ids\/(\d+)(-\d+-\d+)?/,(e,t,n)=>`/ids/${t}-`+o),r.alt=t?.name,document.createElement("p"));l.className="shelfItemName",l.textContent=t?.name,n.appendChild(r),n.appendChild(l),n.appendChild(a),c.appendChild(n)}),n.appendChild(a),n.appendChild(c),t.appendChild(n)},initializeSlider=()=>{let n=parseInt(getDataSetFromElement("corel_container")?.margin,10),r=parseInt(getDataSetFromElement("corel_container")?.itemsperpage,10),l=document.querySelector(".sliderContainer"),a=l.querySelectorAll(".shelfItem"),o=a.length,c=0;let d=()=>{var e=a[0].offsetWidth+n,e=-c*e*r;l.style.transform=`translateX(${e}px)`,t()};let t=()=>{document.querySelectorAll(".dot").forEach((e,t)=>{e.className=t===c?"dot active":"dot"})},e=e=>{var t=Math.ceil(o/r);c=(c+e+t)%t,d()};document.querySelector(".prevButton").addEventListener("click",()=>e(-1)),document.querySelector(".nextButton").addEventListener("click",()=>e(1)),(e=>{let t=e.parentElement.clientWidth/r-n;a.forEach(e=>{e.style.width=t+"px",e.style.marginRight=n+"px"}),e.style.width=(t+n)*o+"px"})(l),(()=>{var t=document.createElement("div"),n=(t.className="dotsContainer",Math.ceil(o/r));for(let e=0;e<n;e++){var a=document.createElement("span");a.className="dot",a.addEventListener("click",()=>{c=e,d()}),t.appendChild(a)}l.parentElement.appendChild(t)})(),d()};
let sendInteractionsToOrderVtex=e=>{(async e=>{var t=(a=await(await fetch("/api/checkout/pub/orderForm",{method:"GET",headers:{"content-type":"application/json"},keepalive:!0})).json())?.orderFormId,a=(a?.customData?.customApps?.find(e=>"wec_ino"==e?.id))?.fields?.shelfItemInteraction;let o;return o=a?[...JSON.parse(a),e]:[e],a={method:"PUT",body:JSON.stringify({value:JSON.stringify(o)}),headers:{"Content-Type":"application/json"},keepalive:!0},await(await fetch(`/api/checkout/pub/orderForm/${t}/customData/wec_ino/shelfItemInteraction`,a)).json()})(e)};